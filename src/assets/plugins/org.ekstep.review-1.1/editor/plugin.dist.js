org.ekstep.pluginframework.pluginManager.registerPlugin({"id":"org.ekstep.review","ver":"1.0","author":"Gourav More","type":"widget","title":"review Plugin","description":"Plugin for send content to review","publishedDate":"","editor":{"main":"editor/plugin.js","menu":[],"help":{"src":"editor/help.md","dataType":"text"},"configManifest":[]},"renderer":{"main":"renderer/plugin.js","dependencies":[{"type":"css","src":"renderer/assets/css/interactivevideo.css"}]}},org.ekstep.contenteditor.basePlugin.extend({type:"review",initialize:function(){ecEditor.addEventListener(this.manifest.id+":review",this.review,this),ecEditor.addEventListener(this.manifest.id+":show",this.loadHtml,this),ecEditor.addEventListener(this.manifest.id+":showDialog",this.showDialog,this),ecEditor.addEventListener(this.manifest.id+":showConflictDialog",this.showConflictDialog,this);var e=ecEditor.resolvePluginResource(this.manifest.id,this.manifest.ver,"editor/review.html"),t=ecEditor.resolvePluginResource(this.manifest.id,this.manifest.ver,"editor/reviewapp.js"),o=ecEditor.resolvePluginResource(this.manifest.id,this.manifest.ver,"editor/reviewConflictDialog.html"),i=ecEditor.resolvePluginResource(this.manifest.id,this.manifest.ver,"editor/editMetaDialog.html");ecEditor.getService("popup").loadNgModules(e,t),ecEditor.getService("popup").loadNgModules(i),ecEditor.getService("popup").loadNgModules(o)},loadHtml:function(e){var t=this;t.contentObj=ecEditor.getService("content").getContentMeta(ecEditor.getContext("contentId")),ecEditor.getService("popup").open({template:"org.ekstep.review.html",controller:"reviewcontroller",controllerAs:"$ctrl",resolve:{instance:function(){return t}},width:900,showClose:!1,closeByEscape:!1,closeByDocument:!1,className:"ngdialog-theme-default"})},review:function(e){var o=this,i=1,n=[];o.contentObj=ecEditor.getService("content").getContentMeta(ecEditor.getContext("contentId")),"Untitled lesson"==o.contentObj.name&&(i=0,n.push("Title")),"Write a short description of your lesson"==o.contentObj.description&&(i=0,n.push("Description")),ecEditor._.each({appIcon:"Lesson Icon",name:"Title",description:"Description",contentType:"Lesson Type",language:"Language",domain:"Domain",owner:"Author",ageGroup:"Age Group",gradeLevel:"Grades"},function(e,t){(void 0===o.contentObj[t]||""==o.contentObj[t]||Array.isArray(o.contentObj[t])&&0==o.contentObj[t].length)&&(i=0,n.push(e))}),1==i?o.loadHtml(o):ecEditor.dispatchEvent("org.ekstep.review:showDialog",{dialogMainText:"Please fill in the following mandatory details.",dialogSubtext:n,isRedirect:!0,isError:!0})},showDialog:function(e,t){var o=this;ecEditor.getService("popup").open({template:"org.ekstep.review.editMetaDialog.html",controller:["$scope",function(e){e.dialogMainText=t.dialogMainText,e.dialogSubtext=t.dialogSubtext,e.isRedirect=t.isRedirect,e.redirectToHome=o.redirectToHome,e.isError=t.isError,e.editContentMeta=function(){ecEditor.dispatchEvent("org.ekstep.ceheader:meta:edit")}}],showClose:!1,closeByEscape:!1,closeByDocument:!1,className:"ngdialog-theme-default"}),t.isError||setTimeout(function(){o.redirectToHome()},1e3)},showConflictDialog:function(e){var t=this;ecEditor.getService("popup").open({template:"org.ekstep.review.reviewConflictDialog.html",controller:"reviewcontroller",controllerAs:"$ctrl",resolve:{instance:function(){return t}},showClose:!1,closeByEscape:!1,closeByDocument:!1,className:"ngdialog-theme-plain reviewConflict"})},redirectToHome:function(){window.location.href=org.ekstep.contenteditor.globalContext.baseURL}}))