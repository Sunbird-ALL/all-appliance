org.ekstep.pluginframework.pluginManager.registerPlugin({"id":"org.ekstep.image","ver":"1.1","shortId":"image","displayName":"Image","author":"Santhosh Vasabhaktula","title":"Image Plugin","description":"","publishedDate":"","editor":{"main":"editor/plugin.js","help":{"src":"editor/help.md","dataType":"text"},"dependencies":[{"type":"plugin","plugin":"org.ekstep.assetbrowser","ver":"1.3"}],"menu":[{"id":"image","category":"main","type":"icon","toolTip":"Add Image","title":"Image","iconClass":"fa fa-picture-o","onclick":{"id":"org.ekstep.image:assetbrowser:open"}}],"behaviour":{"rotatable":true},"configManifest":[{"propertyName":"imagebrowser","title":"Image Browser","description":"Choose a  from the browser","dataType":"browser","required":true,"onclick":{"id":"org.ekstep.assetbrowser:show","type":"image"}}]}},org.ekstep.contenteditor.basePlugin.extend({name:"Image",initialize:function(){ecEditor.addEventListener(this.manifest.id+":assetbrowser:open",this.openBrowser,this)},newInstance:function(){var e=this,i=this.parent,s=(this.parent=void 0,this.convertToFabric(this.attributes)),t=("plugin"==this.attributes.from&&(delete s.width,delete s.height),this.media?this.media[this.attributes.asset]:void 0);if(!t||!t.src)throw new Error("media source is missing!");t&&t.src&&(this.name=this.attributes.asset,t.src=ecEditor.getMediaReverseProxyURL(t.src),t=ecEditor.getConfig("useProxyForURL")?"image/get/"+encodeURIComponent(t.src):t.src,fabric.Image.fromURL(t,function(t){t.strokeWidth=1,e.editorObj=t,e.parent=i,"plugin"==e.attributes.from&&(e.editorObj.scaleToWidth(s.w),delete e.attributes.from),e.postInit()},s))},openBrowser:function(){var e=this;ecEditor.dispatchEvent("org.ekstep.assetbrowser:show",{type:"image",search_filter:{},callback:function(t){t.x=20,t.y=20,t.w=50,t.h=50,t.from="plugin",ecEditor.dispatchEvent(e.manifest.id+":create",t)}})},getCopy:function(){var t=this._super();return t.assetMedia=this.media[this.attributes.asset],t},onConfigChange:function(t,e){"browser"===t&&(ecEditor.dispatchEvent("delete:invoke"),ecEditor.dispatchEvent(this.manifest.id+":create",e))},getDisplayName:function(){return this.name}}))